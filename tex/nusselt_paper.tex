%\documentclass[iop]{emulateapj}
\documentclass[aps, prl, twocolumn, nofootinbib, groupedaddress, amsfonts, amssymb, amsmath]{revtex4-1}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{natbib}
%\usepackage[colorlinks=True, linkcolor=blue, citecolor=blue]{hyperref}
%\usepackage[all]{hypcap}

\bibliographystyle{apsrev}

\newcommand{\Div}[1]{\ensuremath{\nabla\cdot\left( #1\right)}}
\newcommand{\angles}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\grad}{\ensuremath{\nabla}}
\newcommand{\RB}{Rayleigh-B\'{e}nard }
\newcommand{\stressT}{\ensuremath{\bm{\bar{\bar{\Pi}}}}}
\newcommand{\lilstressT}{\ensuremath{\bm{\bar{\bar{\sigma}}}}}
\newcommand{\nrho}{\ensuremath{n_{\rho}}}
\newcommand{\approptoinn}[2]{\mathrel{\vcenter{
	\offinterlineskip\halign{\hfil$##$\cr
	#1\propto\cr\noalign{\kern2pt}#1\sim\cr\noalign{\kern-2pt}}}}}

\newcommand{\appropto}{\mathpalette\approptoinn\relax}

\newcommand\mnras{{MNRAS}}%
          % Monthly Notices of the RAS

\begin{document}
%%%%% Create nice title and abstract
\author{Evan H. Anders}
\affiliation{Department of Astrophysical \& Planetary Sciences, University of Colorado -- Boulder}
\affiliation{Laboratory for Atmospheric and Space Physics, Boulder, CO}
\author{Benjamin P. Brown}
\affiliation{Department of Astrophysical \& Planetary Sciences, University of Colorado -- Boulder}
\affiliation{Laboratory for Atmospheric and Space Physics, Boulder, CO}
\title{Convective heat transport in stratified atmospheres at low and high Mach number}

\begin{abstract}
Convection in astrophysical systems is stratified and
often occurs at high Rayleigh number (Ra) and low
Mach number (Ma).
Here we study stratified convection in the context of 
plane-parallel, polytropically stratified atmospheres. 
We hold the density stratification ($n_{\rho}$), aspect
ratio, and Prandtl 
number (Pr) constant while varying the superadiabaticity
and Ra.  We find that Ma is a strong function of the superadiabaticity
in both 2D and 3D simulations, and that it is a 
weak function of Ra in 2D.
In 2D simulations, the scaling of the Nusselt Number (Nu) and the Reynolds number (Re)
with Ra weaken
once the mean Ma of the solution is unity, but in 3D
Re and Nu seem to have consistent scaling across Ra.
We further find that when the superadiabaticity and Ma are large,
density inversions form in the thermal boundary layers.
%As Ra increases and $\text{Ma} \rightarrow 1$, a scaling 
%of Nu $\propto$ Ra$^{0.45}$ is observed.  
%As Ra increases to a regime where Ma $\geq 1$,
%this scaling gives way to a weaker Nu $\propto$ Ra$^{0.19}$. 
%In the regime of Ma $\ll 1$, a consistent
%Nu $\propto$ Ra$^{0.31}$ is retrieved,  reminiscent of the 
%Nu $\propto$ Ra$^{2/7}$ seen in \RB convection.
\end{abstract}
\maketitle


%%%%% Body of the paper
\section{Introduction}
\refstepcounter{section}
\label{sec:intro}
Convection transports energy in stellar and planetary atmospheres.
In these objects, flows are compressible and
feel the atmospheric stratification.  While in some systems this stratification 
is negligible, it is significant in regions such as
the convective envelope of the Sun, which spans 14 density scale heights.
In the bulk of these systems, flows are at very low Mach number (Ma), 
but numerical constraints have restricted most studies of 
compressible convection to high Ma.
These prior studies have provided important insight into the low temperature, 
high Ma region near the Sun's surface. Few fundamental
properties of low Ma convection, which characterizes deeper motions,
are known.

In the widely-studied \RB (RB) problem of incompressible Boussinesq convection, 
a negative temperature gradient leads to convective instability.
In the evolved solution, upflows and downflows are symmetrical, the
temperature in the interior becomes isothermal and
the conductive flux ($\propto \grad T$) approaches 
zero there. 
For compressible convection in a stratified atmosphere, a
negative entropy gradient leads to convective instability.
Early numerical experiments of moderate-to-high Ma compressible convection
in two \cite{graham1975, chan&all1982,
hurlburt&all1984, cattaneo&all1990} and three 
\cite{cattaneo&all1991, brummell&all1996} dimensions
revealed that the evolved state differs from the RB case.
Downflow lanes
become fast and narrow, and upflow lanes turn into broad, slow upwellings.
Furthermore, the \emph{entropy} gradient is negated by convection in the interior, and
a significant temperature gradient and conductive flux persist in the presence of
efficient convection.

In RB convection, there exist two primary dynamical control parameters: 
the Rayleigh number (Ra, the ratio of
buoyant driving to diffusive damping) and the Prandtl number 
(Pr, the ratio of viscous to thermal
diffusivity). These numbers control two useful
measures of turbulence in the evolved solution:
the Reynolds
number (Re, the strength of advection to viscous diffusion)
and the Peclet number (Pe, advection vs. thermal diffusion).  
In stratified atmospheres, the magnitude of the unstable entropy gradient, 
joins Ra and Pr as an important control parameter.  This 
\emph{superadiabatic excess} \cite{graham1975}, $\epsilon$,
sets the scale of the atmospheric entropy gradient.
We find here that $\epsilon$ primarily controls the Ma of the evolved solution.

In this letter we study the behavior of convective heat transport, 
quantified by the Nusselt number (Nu), in plane-parallel, 
two- and three-dimensional, polytropically stratified atmospheres.  
We vary $\epsilon$ and Ra while holding Pr, aspect ratio, boundary conditions,
and initial atmospheric stratification
constant.  We also examine the behavior of flow properties, as quantifed by Ma and Re.

\section{Experiment} 
\refstepcounter{section}
\label{sec:experiment}
We examine a monatomic ideal gas with an adiabatic index of
$\gamma = 5/3$ whose equation of state is $P = R\rho T$. In this
work we take $R = 1$.
This is consistent with the approach used in earlier work \cite{graham1975, chan&all1982,
hurlburt&all1984, cattaneo&all1990, cattaneo&all1991, brummell&all1996} 
and is the simplest stratified extension of RB.
We study atmospheres which are initially polytropically stratified,
\begin{equation}
\begin{split}
\rho_0(z) &= \rho_{t}(1 + L_z - z)^m, \\
T_0(z)    &= T_{t}(1 + L_z - z),
\label{eqn:polytrope}
\end{split}
\end{equation}
where $m$ is the polytropic index and $L_z$ is the depth of the atmosphere.
Subscript 0 indicates initial conditions and subscript $t$ indicates values
at $z = L_z$.
The height coordinate, $z$, increases upwards in the range $[0, L_z]$.  We
specify the depth of the atmosphere, $L_z = e^{n_{\rho}/m} - 1$, by choosing
the number of density scale heights, $n_{\rho}$, it spans initially.
Throughout this letter we set $n_{\rho} = 3$.  Satisfying hydrostatic
equilibrium sets the value of gravity, $g = T_t (m + 1)$, which is
constant with depth.  We study atmospheres with aspect
ratios of 4 where both the $x$ and $y$ coordinates have the range $[0, 4L_z]$.
In our 2D cases, we only consider $x$ and $z$.

%
%We examine the simplest stratified extension of RB by studying a
%fluid composed of monatomic ideal gas particles with an adiabatic 
%index of $\gamma = 5/3$ and whose equation of state is $P = R\rho T$. 
%This is consistent with the approach used in earlier work.
%The initial atmosphere is a plane-parallel polytrope in which 
%the gravitational acceleration and conductive flux, 
%$\bm{F}_{\text{cond,0}} = -\kappa \partial_z T_0$, do not vary with depth. To
%achieve the latter condition, both $\kappa$ and $\partial_z T_0$ are constant.
%Under these assumptions, satisfying hydrostatic 
%equilibrium produces a stratification of
%\begin{equation}
%\begin{split}
%\rho_0(z) &= \rho_{t}(z_0 - z)^m, \\
%T_0(z)    &= T_{t}(z_0 - z),
%\label{eqn:polytrope}
%\end{split}
%\end{equation}
%where $m = m_{\text{ad}} - \epsilon$ is the polytropic index.
%The adiabatic polytropic index is $m_{\text{ad}} \equiv (\gamma-1)^{-1}$, and
%the superadiabatic excess is $\epsilon$ which sets the scale 
%of the entropy gradient ($\partial_z S_0 \propto -\epsilon$).
%A significant advance of this work is the ability to study large 
%and small values of $\epsilon$, as will be discussed.
%Thermodynamic variables are nondimensionalized at the 
%top of the atmosphere as  $P_0(L_z) = \rho_0(L_z) = T_0(L_z) = 1$, 
%requiring $z_0 \equiv L_z + 1$ and $R = T_{t} = \rho_{t} = 1$.
%By this choice, the non-dimensional length scale is the inverse 
%temperature gradient scale and the timescale is the isothermal 
%sound crossing time of this unit length.
%The height $z$ increases upwards within $[0, L_{z}]$, 
%where $L_{z} = e^{n_{\rho}/m} - 1$ is
%determined by $n_\rho$ and $\epsilon$.
%The characteristic timescale of convective dynamics
%is related to the atmospheric buoyancy time, 
%$t_{\text{b}} = \sqrt{L_z/g\epsilon}$, with $g = (m+1)$.
%Throughout this letter, we use buoyancy time units and 
%choose $n_{\rho} = 3$ such that the 
%initial density varies by a factor of 20.
%All atmospheres studied here have an aspect ratio of 4, 
%such that $L_x = 4L_z$.
%

Convective dynamics are controlled by the superadiabaticity
of the atmospheres as well as the atmospheric diffusivities.
The superadiabaticity, or the magnitude of the (negative) 
entropy gradient, is set by 
the superadiabatic excess, $\epsilon = m_{ad} - m$, where 
$m_{ad} = (\gamma - 1)^{-1}$.
The atmospheric thermal diffusivity, $\chi$,
and kinematic viscosity (viscous diffusivity), $\nu$,
are determined by the Rayleigh number (Ra) and the Prandtl
number (Pr).  We set $\text{Pr } = \nu/\chi = 1$ throughout
this work. The polytropic initial conditions are in
thermal equilibrium, $\kappa_0 \partial_z T_0 =$ const,
so $\kappa_0 = \chi \rho_0$ must be constant. To keep
Pr constant with height, we set $\chi = \chi_t/\rho_0$
and $\nu = \nu_t/\rho_0$.  Under these constraints, the
diffusivity profiles are specified by choosing Ra
at the top of the domain,
\begin{equation}
\text{Ra}_{\text{top}} = \frac{g L_z^3 (\Delta S_0 / c_P)}{\nu_t\chi_t},
\end{equation}
where $\Delta S_0 = \epsilon\ln (1 + L_z)$ is the initial entropy difference 
between the top and bottom of the atmosphere and
$c_P = \gamma(\gamma-1)^{-1}$ is the specific heat 
at constant pressure. The profiles of $\nu$ and $\chi$ are constant with
time, and Ra at the bottom of the atmosphere is greater than Ra$_{\text{top}}$
by a factor of $e^{2n_{\rho}}$.  This formulation leaves
the thermal conductivity, $\kappa = \rho\chi$, and
the dynamic viscosity, $\mu = \rho\nu$, free to evolve
as the density profile changes.  Henceforth,
when we use Ra, we are referring to Ra$_{\text{top}}$.

We evolve the Fully Compressible Navier-Stokes equations,
\begin{align}
&\begin{aligned}
&\frac{\partial \ln\rho}{\partial t} + \grad\cdot\bm{u} 
    = -\bm{u}\cdot\grad\ln\rho,
	\label{eqn:continuity_eqn}
\end{aligned}\\
&\begin{aligned}
\frac{\partial\bm{u}}{\partial t} + \grad T - 
&\nu\grad\cdot\lilstressT - \lilstressT\cdot\grad\nu = \\
&-\bm{u}\cdot\grad\bm{u} - T\grad\ln\rho + \bm{g} + 
\nu\lilstressT\cdot\grad\ln\rho,
\label{eqn:momentum_eqn}
\end{aligned}\\
&\begin{aligned}
\frac{\partial T}{\partial t} -\frac{1}{c_V}\left(\right.\chi&\left.
    \grad^2 T + \grad T\cdot\grad\chi\right) = \\
	&-\bm{u}\cdot\grad T - (\gamma-1)T\grad\cdot{\bm{u}} \\
	&+ \frac{1}{c_V}\left(\chi\grad T \cdot\grad\ln\rho +
	\nu\left[\lilstressT\cdot\nabla\right]\cdot\bm{u}\right), 
	\label{eqn:energy_eqn}
\end{aligned}
\end{align}
with the viscous stress tensor given by
\begin{equation}
\sigma_{ij} \equiv \left(\frac{\partial u_i}{\partial x_j} + 
\frac{\partial u_j}{\partial x_i} - \frac{2}{3}\delta_{ij}\grad\cdot\bm{u}\right).
	\label{eqn:stress_tensor}
\end{equation}
Taking an inner product of
(\ref{eqn:momentum_eqn}) with $\rho\bm{u}$ and adding it to 
$\rho c_V\times$(\ref{eqn:energy_eqn}) reveals the full energy equation,
\begin{equation}
\frac{\partial}{\partial t}\left(\rho\left[\frac{|\bm{u}|^2}{2} + c_V T + \phi\right]\right) +
\Div{\bm{F}_{\text{conv}} + \bm{F}_{\text{cond}}} = 0,
	\label{eqn:energy_eqn_full}
\end{equation}
where
$
\bm{F}_{\text{conv}} \equiv \bm{F}_{\text{enth}} + \bm{F}_{\text{KE}} + \bm{F}_{\text{PE}} + \bm{F}_{\text{visc}}
$
is the convective flux and $\bm{F}_{\text{cond}} = -\kappa \grad T$
is the conductive flux.
The individual contributions to $\bm{F}_{\text{conv}}$ are the enthalpy flux, 
$\bm{F}_{\text{enth}} \equiv \rho\bm{u}(c_V T + P/\rho)$;
the kinetic energy flux, 
$\bm{F}_{\text{KE}} \equiv \rho|\bm{u}|^2\bm{u}/2$;
the potential energy flux,
$\bm{F}_{\text{PE}} \equiv \rho\bm{u}\phi$ (with $\phi \equiv -gz$);
and the viscous flux, 
$\bm{F}_{\text{visc}} \equiv -\rho\nu\bm{u}\cdot\lilstressT$.
Understanding how each of these fluxes interact  
is crucial in characterizing convective heat transport.

We utilize the 
Dedalus\footnote{http://dedalus-project.org/} \cite{burns&all2016} 
pseudospectral framework to time-evolve  
(\ref{eqn:continuity_eqn})-(\ref{eqn:energy_eqn}) 
using an implicit-explicit (IMEX), third-order, four-step 
Runge-Kutta timestepping scheme RK443 \cite{ascher&all1997}.  
We decompose our thermodynamic variables such that $T = T_0 + T_1$ and
$\ln\rho = (\ln\rho)_0 + (\ln\rho)_1$, 
and the velocity $\bm{u} = u\hat{x} + v\hat{y} +  w\hat{z}$.
In our 2D runs, $v = 0$.
Subscript 0 variables, set by (\ref{eqn:polytrope}), 
have no time derivative and vary only in $z$.
Variables are time-evolved on a dealiased Chebyshev (vertical)
and Fourier (horizontal, periodic) domain in which the
physical grid dimensions are 3/2 the size of the coefficient grid.  
Domain sizes range from
64x256 coefficients at the lowest values of 
Ra to 1024x4096 coefficients at Ra $> 10^{7}$ in 2D,
and from 64x128$^2$ to  256x512$^2$ in 3D. 
By using IMEX timestepping, we implicitly step the 
stiff linear acoustic wave contribution and are able to
efficiently study flows at high ($\sim 1$) 
and low ($\sim 10^{-4}$) Ma.  Our equations take the form
of the FC equations in \cite{lecoanet&all2014}, extended to include
$\nu$ and $\chi$ which vary with depth, and we follow the approach there.
This IMEX approach has been successfully 
tested against a nonlinear benchmark  of the compressible 
Kelvin-Helmholtz instability \cite{Lecoanet_et_al_2016_KH}.

We impose impenetrable, stress free, fixed temperature boundary conditions at
the top and bottom of the domain such that 
$w = \partial_z u = T_1 = 0$ at $z = \{0, L_z\}$. 
$T_1$ is initially filled with
random white noise whose magnitude is infinitesimal
compared to $T_0$ and $\epsilon$.
We filter this noise spectrum in coefficient space, 
such that only the lower 25\% of the coefficients
have power. We non-dimensionalize our computational domains by setting
all thermodynamic variables to unity at $z = L_z$ choosing
$R = T_t = \rho_t = 1$.  By this choice, the non-dimensional
length scale is the inverse temperature gradient scale and the 
timescale is the isothermal sound crossing time, 
$\tau_I$, of this unit length.
Meaningful convective dynamics occur on 
timescales of the atmospheric buoyancy time,
$t_b = \tau_I \sqrt{L_z/g\epsilon}$. 
All reported results are taken from time averages
over many $t_b$ beginning \{100, 40\}$t_b$
after the start of our \{2D, 3D\} simulations in order to
assure our results are not biased by the convective transient.

\section{Results}
\refstepcounter{section}
\label{sec:results}


\begin{figure}[t]
\includegraphics[width=3.4375in]{./figs/ma_v_Ra.png}
\caption{The mean adiabatic Mach number of long-time-averaged profiles
is shown.  Error bars show the full range of Ma over the depth of the
atmosphere.
(a) Ma, at various values of Ra, 
is plotted as a function of $\epsilon$.
(b) Ma, at various values of $\epsilon$, 
is plotted as a function of Ra/Ra$_{\text{crit}}$.
Larger symbols with white dots designate 3D runs.
\label{fig:ma_v_eps} }
\end{figure}


Solutions were time-evolved until a long time average of the fluxes
showed little
variance with depth. By performing a linear stability analysis, 
we determined that the onset of convection
occurs at $\text{Ra}_{\text{crit}} = \{11.15, 10.06, 10.97, 10.97\}$ 
for $\epsilon = \{1.0, 0.5, 10^{-4}, 10^{-7}\}$, respectively.  

We measure the adiabatic Mach number (Ma = $|\bm{u}|/\sqrt{\gamma T}$).
We find that Ma is a strong function of 
$\epsilon$ and a weak function of Ra.  
In our 2D runs, when Ma $< 1$ we observe a scaling law of
Ma(Ra$, \epsilon) \propto \epsilon^{1/2}$Ra$^{1/4}$.
this relation breaks down as the mean
Ma approaches 1 (see Fig. \ref{fig:ma_v_eps}).  This transition
occurs near Ra/Ra$_\text{crit} \approx \{10^{2}, 10^{3}\}$ for $\epsilon = \{1, 0.5\}$.
In our limited 3D runs, Ma appears to be a function of $\epsilon$ alone, with
Ma $\propto \epsilon^{1/2}$, so at high Ra, Ma$_{\text{3D}} < \text{Ma}_{\text{2D}}$.
The value of $\epsilon$ also sets the size of the
evolved thermodynamic fluctuations, such that
$T_1/T_0 \propto \epsilon$ and $\rho_1/\rho_0 \propto \epsilon$.  
These fluctuations are very small when $\epsilon$ and Ma are small,
but can be O(1) for values of $\epsilon$ near 1.

\begin{figure}[t]
\includegraphics[width=3.4375in]{./figs/snapshots_fig.png}
\caption{Characteristic entropy fluctuations in evolved 2D flows roughly
140$t_b$ after the start of simulations. 
The time- and horizontally-averaged profile is removed in all cases.  
(a) A low Ma flow at moderate Ra. (b) A high Ma flow at the same Ra as in (a).
(c) a high Ma flow at high Ra.
Shock systems can be seen in the upper atmosphere of the high Ma flows,
for example at $(x, z) \approx (70, 15-19)$ in (b) and $(x, z) \approx 
(65, 17-19)$ in (c).
\label{fig:entropy_snapshots} }
\end{figure}

Low Ma flows (e.g., $\epsilon = 10^{-4}$)
display the classic narrow downflow and broad upflow lanes of stratified
convection (Fig. \ref{fig:entropy_snapshots}a).
At high Ma (e.g., $\epsilon = 0.5$), bulk thermodynamic structures are similar but
shock systems form in the upper atmosphere near downflow lanes 
for sufficiently large values of $\epsilon$ and Ra (Fig. \ref{fig:entropy_snapshots}b,c).
Similar shock phenomena were reported in
both two \cite{cattaneo&all1990} and 
three \cite{malagoli&all1990} dimensional polytropic simulations previously.
As Ra is increased to large values 
(Fig. \ref{fig:entropy_snapshots}c), thermodynamic structures 
no longer span the whole domain but rather break up into 
small eddies which traverse the domain multiple
times before diffusing.  Our choice of fixed-temperature, stress free boundary conditions 
allows the flux at the boundaries to vary, while also allowing
for mean horizontal velocity profiles along the boundaries (winds).
We find these windy convective states, reminiscent of similar states
in RB convection \cite{goluskin&all2014}, at $\epsilon = 10^{-4}$ for high
values of Ra. Roll states (Fig. \ref{fig:entropy_snapshots}a) with high convective
transport alternate with windy states of lower transport.


\begin{figure}[t]
\includegraphics[width=3.4375in]{./figs/re_and_nu_v_Ra.png}
\caption{
Flow properties at high and low $\epsilon$. 
(a) Nu vs. Ra/Ra$_{\text{crit}}$.
Errors bars indicate the variance of Nu with depth;
large error bars indicate a poorly converged solution.
(b) Re vs. Ra/Ra$_{\text{crit}}$.
Re is measured at the midplane of the atmosphere.
Larger symbols with white dots designate 3D runs.
 \label{fig:re_and_nu_v_ra}
}
\end{figure}

The efficiency of convection is quantified by the Nusselt number (Nu).  
Nu is well-defined in RB convection
as the total flux normalized by the steady-state conductive flux 
\cite{johnston&doering2009, otero&all2002}.
In stratified convection Nu is more difficult to define, and we use
a modified version of a traditional stratified Nusselt number 
\cite{graham1975,hurlburt&all1984},
\begin{equation}
\text{Nu} \equiv \frac{\langle F_{\text{conv,z}} + F_{\text{cond,z}} - F_{\text{A}}\rangle}
{\langle F_{\text{cond,z}} - F_{\text{A}}\rangle} 
= 1 + \frac{\langle F_{\text{conv,z}}\rangle}{\langle F_{\text{cond,z}} - F_{\text{A}} \rangle}
\label{eqn:nusselt}
\end{equation}
where $F_{\text{conv,z}}$ and $F_{\text{cond,z}}$ are the 
z-components of $\bm{F}_{\text{conv}}$ and $\bm{F}_{\text{cond}}$,
and $\langle \rangle$ are volume averages.  
$F_{\text{A}} \equiv -\langle\kappa\rangle \partial_z T_{\text{ad}}$ 
is the conductive flux of the proper corresponding adiabatic atmosphere
For a compressible ideal gas in hydrostatic equilibrium,
$\partial_z T_{\text{ad}} \equiv - g / c_{P}$ \cite{spiegel&veronis1960}.  
It is important to measure the evolved value of
$\langle \kappa \rangle = \langle \rho\chi \rangle$, which is nearly
$\kappa_0$ when $\epsilon$ is small but can change appreciably for large
values of $\epsilon$.
In incompressible Boussinesq convection, where $\grad S = 0$ only when 
$\grad T = 0$, this definition reduces to the traditional definition
of the Nusselt number \cite{otero&all2002, johnston&doering2009}.

The variation of Nu with Ra is shown in 
Fig. \ref{fig:re_and_nu_v_ra}a.  We find that the Nu depends primarily
on Ra, not on $\epsilon$, except where dynamical regimes change.
In 2D and at low to moderate Ra, 
Nu $\propto$ Ra$^{1/3}$ regardless of $\epsilon$,
reminiscent of scaling laws in classical \RB theory \cite{king&all2012}.
As the flow becomes supersonic,  Nu $\propto$ Ra$^{1/5}$.
2D runs at $\text{Ra }> 10^3$Ra$_{\text{crit}}$
and $\epsilon = 10^{-4}$ exhibit windy convective states.
In these runs, the system is in flux equilibrium only when
time averaged over roll states and windy states.
A long time average
over both of these states produces a flat flux profile which
can be sensibly analyzed, but the presence of these time-dependent states
makes it difficult to equilibrate these higher Ra cases.
It is also important to note that
the value of Nu is heavily dependent upon the specific thermodynamic
structures of the solution, as double roll states will transport
heat more efficiently than single roll states, and slight changes in
Ra can result in a simulation latching on to one solution or the other.
In our limited 3D runs, it appears that Nu $\propto$ Ra$^{2/7}$, a classic scaling law
seen in RB studies \cite{johnston&doering2009}.

The rms Reynolds number (Re = $|\bm{u}|L_z/\nu$) and Peclet number
(Pe = Pr Re)
compare the importance of advection to diffusion in the evolved
convective state.  For Pr = 1, such as in this work, Pe = Re.  
Our choice of $\{\nu,\chi\}\propto \rho_0^{-1}$ drastically changes
the value of Re between the top and bottom of the atmosphere.  We report values of
Re at the midplane ($z=L_z/2$) of the atmosphere in
Fig. \ref{fig:re_and_nu_v_ra}b.  Largely we find that Ra and
Pe depend on Ra, but not $\epsilon$, except when the flow states
change.
In 2D and at low Ra, Re $\propto$ Ra$^{3/4}$.  When the flows
become supersonic, 
this scaling gives way to Re $\propto$ Ra$^{1/2}$.
In our limited 3D runs, the scaling of Re is
Re $\propto$ Ra$^{1/2}$, consistent with the supersonic results.

\begin{figure}[t]
\includegraphics[width=3.4375in]{./figs/density_v_ra.png}
\caption{\label{fig:nrho_v_ra} 
Solid symbols show the density contrast measured
in density scale heights between the upper and lower boundary, 
$n_\rho = \ln[\rho(z=0)/\rho(z=L_z)]$.
Empty symbols show 
$n_\rho = \ln[\text{max}(\rho)/\text{min}(\rho)]$. 
At low $\epsilon$ the evolved
$n_{\rho}$ is close to the initial conditions of $n_\rho = 3$.  
At high $\epsilon$,
the density stratification decreases.  Once the mean 
Ma approaches 1 (at Ra/Ra$_{\text{crit}} \approx \{10^2, 10^3\}$ for $\epsilon = \{1, 0.5\}$
as in Fig. \ref{fig:ma_v_eps}b), density inversions form within the thermal
boundary layers. Larger symbols represent 3D runs.}
\end{figure}

In the evolved state, the flows change the density stratification,
as shown in Fig. \ref{fig:nrho_v_ra}.
We find that supersonic flows support persistent density inversions (empty symbols)
in the boundary layers, as
was reported by \cite{brandenburg&all2005}.  We find this in 2D and 3D.
Surprisingly, the evolved $n_\rho$ is always less than the initial $n_\rho = 3$,
and turbulent pressure support plays a larger role than atmospheric slumping.
The agreement of Nu, Re across $\epsilon$ (Fig. \ref{fig:re_and_nu_v_ra}), 
particularly at low Ra in which all four of our cases collapse onto a single
power law, is striking in light of the vastly different evolved stratifications
felt by the flows. 

\section{Discussion}
\refstepcounter{section}
\label{sec:discussion}
In this letter we have studied fundamental heat transport by 
stratified convection in simplified 2D and 3D polytropic atmospheres.
We argue that these atmospheres are the natural extension
of the RB problem to stratified systems, 
and are an ideal laboratory for understanding the basic 
properties of stratified convection. 
The primary difference we see between our 2D and 3D results is that the Ma
is not a function of Ra in 3D, and this has far-reaching consequences.  Otherwise,
we see only slightly different scaling in Nu(Ra) in 2D and 3D, 
which aligns with expectations
of Boussinesq theory and numerical simulation results at 
values of Pr $\geq$ 1 \cite{ahlers&all2009}.  

At low Ra and Ma, the scaling of Nu with Ra is reminiscent of RB convection.  
However, at high Ra and Ma, the scaling of Nu becomes weaker, changing
from a 1/3 to a 1/5 power law, a decrease by nearly a factor of 1/3.
Similarly, the Reynolds number switches from a 3/4 power law to
a 1/2 scaling in this regime shift, a similar decrease.
This seems to suggest that a large portion of the scaling of the Nusselt number
and Reynolds number in the low-Ma regime
comes from increases in velocity.  Once the velocity reaches
its natural maximum, heat transport can no longer benefit from increased velocities.
The same is true of the Reynolds number, which scales directly with system diffusivities
once the Mach number reaches its maximum value.

Time-dependent oscillating shear states have developed spontaneously
at values of $\epsilon=10^{-4}$ and Ra $\gtrsim 10^3$Ra$_{\text{crit}}$ in our 2D simulations.  
Similar states have been observed in 2D RB convection \cite{goluskin&all2014}, and these should
be studied in more detail.  These states are fundamentally in flux disequilibrium
and last for large time scales (O(100$t_b$)),
making it very difficult to choose a proper time window over which to calculate a 
meaningful Nusselt number.  It would
be beneficial for future studies to examine atmosperes with fixed flux or no slip
boundary conditions to better converge and study cases at low $\epsilon$ and high
Ra.

Finally, we have found that the stratification of 
these atmospheres evolves in a complex
manner.  Future work should aim to 
understand the importance of stratification on
convective heat transport, and the manner in which
boundary layer density inversions interact with
the formation and transport properties of thermal plumes.

Our studies
here will serve as a foundation both for understanding and 
comparing heat transport in stratified convection
to that in RB convection \cite{johnston&doering2009}, 
and for future studies of transport in stratified convection.  
These results can be used to determine if simplified equation sets, 
such as the anelastic equations, carry heat in the same manner as the 
FC equations.
This work will also be useful in coming to understand more realistic systems, 
such as rapidly rotating atmospheres \cite{julien&all2012},
atmospheres bounded by stable regions \cite{hurlburt&all1986}, 
or regions with realistic profiles of $\kappa$.



\subsection{acknowledgements}
EHA acknowledges the support of the University of Colorado's George 
Ellery Hale Graduate Student Fellowship.
This work was additionally supported by  NASA LWS grant number NNX16AC92G.  
Computations were conducted 
with support by the NASA High End Computing (HEC) Program through the NASA 
Advanced Supercomputing (NAS) Division at Ames Research Center on Pleiades
with allocations GID s1647 and GID g26133.
We thank Jon Aurnou, Axel Brandenburg, Keith Julien, Mark Rast, and Jeff Oishi 
for many useful discussions. We also thank the two anonymous referees whose
critical comments greatly improved the quality of this letter.

\bibliography{../biblio.bib}
\end{document}
